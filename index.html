<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<title>Home</title>

	<!-- Global stylesheets -->
	<link href="https://fonts.googleapis.com/css?family=Roboto:400,300,100,500,700,900" rel="stylesheet" type="text/css">
	<link href="global_assets/css/icons/icomoon/styles.min.css" rel="stylesheet" type="text/css">
	<link href="assets/css/all.min.css" rel="stylesheet" type="text/css">
	<link href="assets/css/styles.css" rel="stylesheet" type="text/css">
	<!-- /global stylesheets -->

	<!-- Core JS files -->
	<script src="global_assets/js/main/jquery.min.js"></script>
	<script src="global_assets/js/main/bootstrap.bundle.min.js"></script>
	<!-- /core JS files -->

	<!-- Theme JS files -->
	<script src="global_assets/js/plugins/visualization/d3/d3.min.js"></script>
	<script src="global_assets/js/plugins/visualization/d3/d3_tooltip.js"></script>
	<script src="global_assets/js/plugins/ui/moment/moment.min.js"></script>
	<script src="global_assets/js/plugins/pickers/daterangepicker.js"></script>

	<script src="assets/js/app.js"></script>
	<script src="global_assets/js/demo_pages/dashboard.js"></script>
	<script src="global_assets/js/demo_charts/pages/dashboard/light/streamgraph.js"></script>
	<script src="global_assets/js/demo_charts/pages/dashboard/light/sparklines.js"></script>
	<script src="global_assets/js/demo_charts/pages/dashboard/light/lines.js"></script>	
	<script src="global_assets/js/demo_charts/pages/dashboard/light/areas.js"></script>
	<script src="global_assets/js/demo_charts/pages/dashboard/light/donuts.js"></script>
	<script src="global_assets/js/demo_charts/pages/dashboard/light/bars.js"></script>
	<script src="global_assets/js/demo_charts/pages/dashboard/light/progress.js"></script>
	<script src="global_assets/js/demo_charts/pages/dashboard/light/heatmaps.js"></script>
	<script src="global_assets/js/demo_charts/pages/dashboard/light/pies.js"></script>
	<script src="global_assets/js/demo_charts/pages/dashboard/light/bullets.js"></script>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

	<script src="global_assets/js/plugins/extensions/jquery_ui/interactions.min.js"></script>
	<script src="global_assets/js/plugins/forms/selects/select2.min.js"></script>
	<script src="global_assets/js/demo_pages/form_select2.js"></script>

	<script src="global_assets/js/demo_pages/form_input_groups.js"></script>
	<script src="global_assets/js/plugins/forms/inputs/touchspin.min.js"></script>

	<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
	<!-- /theme JS files -->

</head>

<body>

	<!-- Main navbar -->
	<div class="navbar navbar-expand-lg navbar-dark navbar-static">
		<div class="d-flex flex-1 d-lg-none">
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-mobile">
				<i class="icon-paragraph-justify3"></i>
				<span class="badge badge-mark border-warning m-1"></span>
			</button>
		</div>

		<div class="navbar-brand wmin-0 mr-lg-5">
			<a id="header-patient-name" href="index.html" class="d-inline-block"></a>
		</div>
		

		<div class="navbar-brand wmin-0 mr-lg-5">
			<a href="index.html" class="d-inline-block">
				<img src="global_assets/images/logo_light.png" class="d-none d-sm-block" alt="">
				<img src="global_assets/images/logo_icon_light.png" class="d-sm-none" alt="">
			</a>
		</div>

		<div class="collapse navbar-collapse order-2 order-lg-1" id="navbar-mobile">
			<ul class="navbar-nav">

			</ul>
		</div>

	</div>
	<!-- /main navbar -->

	<!-- Footer navbar -->
	<div id="footer" class="navbar navbar-expand navbar-light px-0 px-lg-3">
		<div class="overflow-auto overflow-lg-visible scrollbar-hidden flex-1">
			<ul class="navbar-nav flex-row text-nowrap">
				<li id="footer-item" class="nav-item">
					<a href="index.html" class="navbar-nav-link active">
						<i class="icon-home4 mr-2"></i>
					</a>
				</li>	
				<li id="footer-item" class="nav-item">
					<a href="a_patient.html" class="navbar-nav-link active">
						<i class="icon-user mr-2"></i>
					</a>
				</li>	
				<li id="footer-item" class="nav-item">
					<a href="index.html" class="navbar-nav-link active">
						<i class="icon-stack-text mr-2"></i>
					</a>
				</li>	
				<li id="footer-item" class="nav-item">
					<a href="index.html" class="navbar-nav-link active">
						<i class="icon-search4 mr-2"></i>
					</a>
				</li>	
				<li id="footer-item" class="nav-item">
					<a href="index.html" class="navbar-nav-link active">
						<i class="icon-vcard mr-2"></i>
					</a>
				</li>					
			</ul>
		</div>
	</div>
	<!-- /secondary navbar -->
		

	<!-- Page content -->
	</br>

	<div class="page-content pt-0">

		<!-- Main content -->
		<div class="content-wrapper">

			<!-- Content area -->
			<div class="content">

				<!-- Main charts -->
				<div class="row">
					<div class="col-xl-7">

						<!-- Horizontal form -->
						<div id="card" class="card">
							<div class="card-header header-elements-inline">
								<h5 id="card-title" class="card-title">Patient Details</h5>
								<div class="header-elements">
									<div class="list-icons">
										<a class="list-icons-item" data-action="collapse"></a>
										<a class="list-icons-item" data-action="reload"></a>
									</div>
								</div>
							</div>

							<div class="collapse show">
								<div class="card-body">
									<form id="patient-details-form">
										<div class="form-group row">
											<label id="card-label-first" class="col-lg-3 col-form-label">Mobile</label>
											<div class="col-lg-9">
												<div class="input-group">
													<input id="mobile-number" type="number" class="form-control" placeholder="Right spinner">
													<span class="input-group-append">
														<span class="input-group-text"><i class="icon-spinner2 spinner"></i></span>
													</span>
												</div>
											</div>
										</div>

										<div class="form-group row">
											<label id="card-label" class="col-lg-3 col-form-label">Name</label>
											<div class="col-lg-9">
												<input  id="name-data" type="text" class="form-control" name="search">
											</div>
										</div>


										<div id="age-group" class="form-group row">
											<label id="card-label" class="col-lg-3 col-form-label">Age </label>
											<div class="col-lg-9">
												<input id="age-data" type="text" value="35" class="form-control touchspin-empty">
											</div>
										</div>


										<div id="gender-group" class="form-group row">
											<label id="card-label" class="col-lg-3 col-form-label">Gender</label>
											<div class="col-lg-9">
												<div id="gender-button" class="btn-group btn-group-toggle" data-toggle="buttons">
													<label id="gender-button-male" class="btn btn-light">
													  <input type="radio" name="options" id="male" autocomplete="off"> Male 
													</label>
													<label id="gender-button-female" class="btn btn-light">
													  <input type="radio" name="options" id="female" autocomplete="off"> Female
													</label>
												</div>
											</div>
										</div>
										<div class="text-right">
											<button id="new-patient-button" type="submit" class="btn btn-primary">New Patient<i class="icon-paperplane ml-2"></i></button>
										</div>
									</form>
								</div>
							</div>
						</div>
						<!-- /horizotal form -->

					</div>

					<div class="col-xl-5">

						<!-- Sales stats -->
						<div id="card" class="card">

								<div class="card">
	
									<div class="card-body">
										<ul id="tab-body" class="nav nav-tabs nav-tabs-bottom nav-justified">
											<li id="vital-signs-button" class="nav-item"><a href="#justified-right-icon-tab2" class="nav-link active" data-toggle="tab">Vital Signs <i id="tab-lable" class="icon-menu7 ml-2"></i></a></li>
											<li id="allergies-button" class="nav-item"><a href="#justified-right-icon-tab2" class="nav-link" data-toggle="tab">Allergies <i id="tab-lable" class="icon-mention ml-2"></i></a></li>
											<li id="tab-button" class="nav-item dropdown">
												<a id="tab-lable" href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Other <i id="tab-lable" class="icon-gear ml-2"></i></a>
												<div class="dropdown-menu dropdown-menu-right">
													<a id="food-allergies-button" href="#justified-right-icon-tab3" class="dropdown-item" data-toggle="tab">Food Allergies</a>
													<a id="other-button" href="#justified-right-icon-tab4" class="dropdown-item" data-toggle="tab">Other</a>
													<a id="remark-button" href="#justified-right-icon-tab4" class="dropdown-item" data-toggle="tab">Remark</a>
												</div>
											</li>
										</ul>
									</div>
								</div>
							<div class="card-body py-0">

								<div id="vital-signs-box" class="form-group">
									<label id="card-title" >Vital Signs</label>
									<select multiple="multiple" class="form-control select" data-fouc>
										<optgroup label="Vital Signs">
											<option value="No Breastfeeding" selected>No Breastfeeding</option>
											<option value="No liver diseases" selected>No liver diseases</option>
											<option value="No kidney diseases">No kidney diseases</option>
											<option value="No Current Medications">No Current Medications</option>
											<option value="No chronic diseases">No chronic diseases</option>
											<option value="No drug allergy">No drug allergy</option>
											<option value="No Pregnancy">No Pregnancy</option>
											<option value="Pregnancy">Pregnancy</option>
											<option value="Lactation">Lactation</option>
											<option value="Chronic Liver disease">Chronic Liver disease</option>
											<option value="Chronic Kidney disease">Chronic Kidney disease</option>
											<option value="End stage irreversible pathology">End stage irreversible pathology</option>
											<option value="One year survival prognosis very low">One year survival prognosis very low</option>
											<option value="Functional impairment severe">Functional impairment severe</option>
											<option value="Cognitive impairment severe">Cognitive impairment severe</option>
											<option value="Therapeutic aim symptom control">Therapeutic aim symptom control</option>
										</optgroup>
									</select>
								</div>

								<div id="allergies-box" class="form-group">
									<label id="card-title" >Allergies</label>
									<select multiple="multiple" class="form-control select" data-fouc>
										<optgroup label="Vital Signs">
											<option value="Amoxicillin" selected>Amoxicillin</option>
											<option value="Aspirin" >Aspirin</option>
											<option value="Augmetin" >Augmetin</option>
											<option value="Cephalexin" >Cephalexin</option>
											<option value="Cloxacillin" >Cloxacillin</option>
											<option value="Cloxil" >Cloxil</option>
											<option value="Coamoxyclay" >Coamoxyclay</option>
											<option value="Diclofenac" >Diclofenac</option>
											<option value="Ibuprofen" >Ibuprofen</option>
											<option value="Mefenamic acid" >Mefenamic acid</option>
											<option value="Miscellaneous" >Miscellaneous</option>
											<option value="Penicillins" >Penicillins</option>
											<option value="Sulpha" >Sulpha</option>
											<option value="Unknown drug" >Unknown drug</option>
										</optgroup>
									</select>
								</div>

								<div id="food-allergies-box" class="form-group">
									<label id="card-title" >Food Allergies</label>
									<div class="form-group row">
										<div class="col-lg-9">
											<textarea  id="food-allergies-data" type="text" class="form-control" placeholder="write the food allegeries"></textarea>
										</div>
									</div>
								</div>

								<div id="other-box" class="form-group">
									<label id="card-title" >Other</label>
									<div class="form-group row">
										<div class="col-lg-9">
											<textarea  id="other-data" type="text" class="form-control" placeholder="write"></textarea>
										</div>
									</div>
								</div>

								<div id="remark-box" class="form-group">
									<label id="card-title" >Remark</label>
									<div class="form-group row">
										<div class="col-lg-9">
											<textarea  id="remark-data" type="text" class="form-control" placeholder="write"></textarea>
										</div>
									</div>
								</div>

							</div>			 
						</div>
						<!-- /sales stats -->
					</div>
				</div>
				<!-- /main charts -->
				
			</div>
			<!-- /content area -->

		</div>
		<!-- /main content -->

	</div>
	<!-- /page content -->


	<script>

		/* starts -- defines common functions (using over the script file) */

		function genderBtnChangeForMale() {
			$("#gender-button-male").removeClass("btn btn-light");
			$("#gender-button-male").addClass("btn btn-info active");

			$("#gender-button-female").removeClass("btn btn-info active");
			$("#gender-button-female").addClass("btn btn-light");
		}

		function genderBtnChangeForFemale() {
			$("#gender-button-female").removeClass("btn btn-light");
			$("#gender-button-female").addClass("btn btn-info active");

			$("#gender-button-male").removeClass("btn btn-info active");
			$("#gender-button-male").addClass("btn btn-light");
		}

		function initialGenderButton() {
			$("#gender-button-female").removeClass("btn btn-info active");
			$("#gender-button-female").addClass("btn btn-light");
			
			$("#gender-button-male").removeClass("btn btn-info active");
			$("#gender-button-male").addClass("btn btn-light");
		}

		/* ends -- defines common functions (using over the script file) */



		/* starts function to send a object of patient and gender button working */

		var gender;
		var titleOfName;
		var newPatientBtn = document.getElementById("new-patient-button");

		$("#gender-button-female").click(function(){
			genderBtnChangeForFemale();

			gender = "Female";
			titleOfName = "Mrs.";
		});

		$("#gender-button-male").click(function(){
			genderBtnChangeForMale();

			gender = "Male";
			titleOfName = "Mr."
		});

		const patientDetailsForm = document.getElementById("patient-details-form");

		patientDetailsForm.addEventListener('submit', function (e) {
			e.preventDefault();

			var mobileNumberStr = document.getElementById("mobile-number").value;
			var mobileNumber = parseInt(document.getElementById("mobile-number").value);
			var name = document.getElementById("name-data").value;
			var age = parseInt(document.getElementById("age-data").value);

			var userData = {mobileNumber, titleOfName, name, age, gender}
			
			/* starts entering valid data */

			if (mobileNumberStr === "") {
				swal("Mobile Number?", 'Enter Mobile Number', "error")
			} else if (mobileNumber >= 1000000000) {
				swal("Not a Valid Mobile Number!", 'Enter a Valid Mobile Number', "error")
			} else if (name === "") {
				swal("Name?" , `Enter Patient Name`, "error");
			} else if (gender === undefined) {
				swal("Gender?" , `Select Patient Gender`, "error");
			}

			if (mobileNumberStr != "" && name != "" && gender != undefined && mobileNumber < 1000000000) {
				console.log(userData);
				newPatientBtn.style.display = 'none';
				swal("New Patient Created!" , `Patient: ${titleOfName} ${name}`, "success");

				/* starts set patient data to local storage */

				window.localStorage.setItem("patientMobile", mobileNumber)
				window.localStorage.setItem("patientName", name)
				window.localStorage.setItem("patientAge", age)
				window.localStorage.setItem("patientTitle", titleOfName)
				window.localStorage.setItem("patientGender", gender)

				/* ends set patient data to local storage */

				document.getElementById("header-patient-name").innerHTML = `${titleOfName} ${name}`; 
				
			}

			/* ends entering valid data */

			// var xhr = new XMLHttpRequest();				/* request send to the userData to API */
			// xhr.open("POST", 'patient.php', true);
			// xhr.setRequestHeader('Content-Type', 'application/json');
			// xhr.send(JSON.stringify({
			// 	value: userData
			// }));

		})

		/* ends function to send a object of patient and gender button working */



		/* starts function for vital signs, allergies, other comments display */

		const vitalSignsBox = document.getElementById("vital-signs-box");
		const vitalSignsBtn = document.getElementById("vital-signs-button");
		
		const allergiesBox = document.getElementById("allergies-box");
		const allergiesBtn = document.getElementById("allergies-button");

		const foodAllergiesBox = document.getElementById("food-allergies-box");
		const foodAllergiesBtn = document.getElementById("food-allergies-button");

		const otherBox = document.getElementById("other-box");
		const otherBtn = document.getElementById("other-button");

		const remarkBox = document.getElementById("remark-box");
		const remarkBtn = document.getElementById("remark-button");

		allergiesBox.style.display = 'none';
		foodAllergiesBox.style.display = 'none';
		otherBox.style.display = 'none';
		remarkBox.style.display = 'none';

		vitalSignsBtn.addEventListener('click', function handleClick() {
			if (vitalSignsBox.style.display === 'none') {
				vitalSignsBox.style.display = 'block';
				allergiesBox.style.display = 'none';
				foodAllergiesBox.style.display = 'none'
				otherBox.style.display = 'none'
				remarkBox.style.display = 'none'
			} 

			// intially vital sign box displayed
			vitalSignsBox.style.display = 'block';
			allergiesBox.style.display = 'none';
			foodAllergiesBox.style.display = 'none'
			otherBox.style.display = 'none'
			remarkBox.style.display = 'none'
		});

		allergiesBtn.addEventListener('click', function handleClick() {
			if (allergiesBox.style.display === 'none') {
				allergiesBox.style.display = 'block';
				vitalSignsBox.style.display = 'none';
				foodAllergiesBox.style.display = 'none'
				otherBox.style.display = 'none'
				remarkBox.style.display = 'none'
			} 
		});

		foodAllergiesBtn.addEventListener('click', function handleClick() {
			if (foodAllergiesBox.style.display === 'none') {
				foodAllergiesBox.style.display = 'block';
				vitalSignsBox.style.display = 'none';
				allergiesBox.style.display = 'none';
				otherBox.style.display = 'none'
				remarkBox.style.display = 'none'
			} 
		});

		otherBtn.addEventListener('click', function handleClick() {
			if (otherBox.style.display === 'none') {
				otherBox.style.display = 'block';
				vitalSignsBox.style.display = 'none';
				allergiesBox.style.display = 'none'
				foodAllergiesBox.style.display = 'none'
				remarkBox.style.display = 'none'
			} 
		});

		remarkBtn.addEventListener('click', function handleClick() {
			if (remarkBox.style.display === 'none') {
				remarkBox.style.display = 'block';
				vitalSignsBox.style.display = 'none';
				allergiesBox.style.display = 'none'
				foodAllergiesBox.style.display = 'none'
				otherBox.style.display = 'none'
			} 
		});

		/* ends function for vital signs, allergies, other comments display */



		/* starts to load patients.json data to website and create objects array fopr patients */

		var xhr = new XMLHttpRequest();
        var patientDataByMobileNumber = {};
		var patientArray;

		xhr.overrideMimeType("application/json");
		xhr.open('GET', 'data/patients.json', true);
		xhr.onreadystatechange = function () {
			if (xhr.readyState == 4 && xhr.status == "200") {
				var content = JSON.parse(this.response);
				var	i, count, mobileNumber;

				patientArray = content['patients'];		 						/* if you need patient data without titles use this */

				for (i = 0, count = patientArray.length; i < count; i++) {		/* get patient data with mobile number (for search function to perform) */
					mobileNumber = patientArray[i]['mobileNumber'];
					patientDataByMobileNumber[mobileNumber] = patientArray[i];
				}

				console.log(patientArray);
				console.log(patientDataByMobileNumber);
			}

		};
		xhr.send(null);

		/* ends to load patients.json data to website and create objects array fopr patients */



		/* starts to find existing patients when inputs mobile number */

		patientDetailsForm.oninput = function() {
			var mobileNumber = parseInt(document.getElementById("mobile-number").value);

			console.log(mobileNumber);

			if (mobileNumber && patientDataByMobileNumber[mobileNumber]) {

				console.log(patientDataByMobileNumber[mobileNumber]);
				
				document.getElementById("name-data").value = patientDataByMobileNumber[mobileNumber].name;
				document.getElementById("age-data").value = patientDataByMobileNumber[mobileNumber].age;
				newPatientBtn.style.display = 'none';

				swal("Patient Available!" , `Patient: ${patientDataByMobileNumber[mobileNumber].titleOfName} ${patientDataByMobileNumber[mobileNumber].name}`, "success");

				/* starts set patient data to local storage */

				window.localStorage.setItem("patientMobile", patientDataByMobileNumber[mobileNumber].mobileNumber)
				window.localStorage.setItem("patientName", patientDataByMobileNumber[mobileNumber].name)
				window.localStorage.setItem("patientAge", patientDataByMobileNumber[mobileNumber].age)
				window.localStorage.setItem("patientTitle", patientDataByMobileNumber[mobileNumber].titleOfName)
				window.localStorage.setItem("patientGender", patientDataByMobileNumber[mobileNumber].gender)

				/* ends set patient data to local storage */

				document.getElementById("header-patient-name").innerHTML = `${patientDataByMobileNumber[mobileNumber].titleOfName} ${patientDataByMobileNumber[mobileNumber].name}`; 

				if (patientDataByMobileNumber[mobileNumber].gender === "Female") {
					genderBtnChangeForFemale();

				} else if (patientDataByMobileNumber[mobileNumber].gender === "Male") {
					genderBtnChangeForMale();

				} 
			} else {
				newPatientBtn.style.display = 'block';

				// document.getElementById("name-data").value = "";   /* when mobile number is not exist you need to create a new user, so execute that you can not use this "else" statement */   
				// document.getElementById("age-data").value = "";		/* when you found a user using mobile number and then the input fields automatically filled then - */
																		/* - you change again the number then you need to make empty input fields but it can not perform in this format */
				// initialGenderButton();									

			}

			return false;   	/* must return false to prevent the default form behavior */
		}

		/* ends to find existing patients when inputs mobile number */


	</script>

</body>
</html>
